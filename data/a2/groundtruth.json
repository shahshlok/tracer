[
    {
        "id": "NM_FLOW_01",
        "category": "The Teleological Control Machine",
        "name": "Accumulator Amnesia (Scope Error)",
        "applicable_questions": ["Q1"],
        "explanation": "The student resets the accumulator variable inside the loop body instead of initializing it once before the loop. This causes the 'sum' to forget its history on every iteration.",
        "student_thinking": "\"I need a sum variable. I'm calculating it inside the loop, so I'll declare it inside the loop to keep it safe.\"",
        "instructions_for_llm": {
            "Q1": "Inside the for loop body, write `int sum = 0;` then `sum += num;`. Print 'Sum of even numbers: X' ONCE AFTER the loop ends. The code must compile but produce the wrong result (only the last number)."
        }
    },
    {
        "id": "NM_FLOW_02",
        "category": "The Teleological Control Machine",
        "name": "The Intent Loop (Off-by-One)",
        "applicable_questions": ["Q1", "Q4"],
        "explanation": "The student uses loop bounds based on the 'count' of items desired, ignoring 0-indexing or the start value. They assume the loop 'knows' to run N times.",
        "student_thinking": "\"I want 5 numbers, so I write i < 5. But I started i at 1. The computer should know I still mean 5 items.\"",
        "instructions_for_llm": {
            "Q1": "Start the loop at `int i = 1` but use the condition `i < 5`. This results in 4 iterations instead of 5.",
            "Q4": "Use `for (int row = 1; row < height; row++)` (Strict inequality). This prints one row too few."
        }
    },
    {
        "id": "NM_FLOW_03",
        "category": "The Teleological Control Machine",
        "name": "Infinite Loop (State Stagnation)",
        "applicable_questions": ["Q2"],
        "explanation": "The student checks a condition in a while loop but fails to update the state variable (input) inside the body. They assume the loop implicitly 'asks again'.",
        "student_thinking": "\"I check if guess != answer at the top. If it is wrong, the loop repeats and naturally waits for a new guess.\"",
        "instructions_for_llm": {
            "Q2": "Read the guess ONCE before the loop. Inside the `while` loop, print 'Too high/low' but DO NOT call `scanner` again. This creates an infinite loop."
        }
    },
    {
        "id": "NM_LOGIC_01",
        "category": "The Independent Switch",
        "name": "Mutually Exclusive Fallacy",
        "applicable_questions": ["Q3"],
        "explanation": "The student uses separate `if` statements instead of `else if`, believing the conditions act as exclusive buckets. This leads to double-counting (e.g., 95 prints both A and B).",
        "student_thinking": "\"I'll check each grade separately. If it's > 90, print A. If it's > 80, print B. They are separate rules.\"",
        "instructions_for_llm": {
            "Q3": "Write `if (grade >= 90) println A;` then on the next line `if (grade >= 80) println B;`. Do NOT use `else`. A grade of 95 must print both A and B."
        }
    },
    {
        "id": "NM_LOGIC_02",
        "category": "The Independent Switch",
        "name": "Dangling Else (Indentation Trap)",
        "applicable_questions": ["Q3"],
        "explanation": "The student relies on indentation to define logic rather than braces, leading to a dangling else binding to the wrong if.",
        "student_thinking": "\"I indented the else to match the first if, so it belongs to the first if.\"",
        "instructions_for_llm": {
            "Q3": "Write nested ifs without braces: `if (grade >= 60) if (grade >= 70) print C; else print F;`. The else visually aligns with the first if but binds to the second."
        }
    },
    {
        "id": "NM_FLOW_04",
        "category": "The Teleological Control Machine",
        "name": "Sabotaging the Future (Inner Loop Mod)",
        "applicable_questions": ["Q4"],
        "explanation": "The student accidentally modifies the outer loop's control variable inside the inner loop, destroying the iteration logic.",
        "student_thinking": "\"I need to reset the row count for the next line, so I'll mess with the row variable here.\"",
        "instructions_for_llm": {
            "Q4": "In the inner loop (drawing stars), increment the OUTER loop variable (e.g., `row++`) instead of the inner one, or reset `row = 0` inside."
        }
    }
]